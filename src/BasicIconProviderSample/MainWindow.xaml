<Window x:Class="BasicIconProviderSample.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="BasicIconProvider Sample" Height="450" Width="600">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- パス入力 -->
        <TextBox x:Name="PathBox"
                 Width="400"
                 Height="28"
                 VerticalAlignment="Center"
                 Margin="0,0,0,10"
                 Text="C:\Windows\explorer.exe"/>

        <!-- アイコン取得ボタン -->
        <Button Grid.Row="1"
                Content="Get Icon"
                Width="120"
                Height="30"
                Margin="0,0,0,10"
                Click="OnGetIcon"/>

        <!-- 取得したアイコン表示 -->
        <Image Grid.Row="2"
               x:Name="IconImage"
               Width="64"
               Height="64"
               Margin="0,0,0,20"/>

        <!-- 複数ファイルのアイコン一覧 -->
        <ListBox Grid.Row="3"
                 x:Name="FileList">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Orientation="Horizontal" Margin="0,4">
                        <Image Source="{Binding Icon}"
                               Width="24"
                               Height="24"
                               Margin="0,0,10,0"/>
                        <TextBlock Text="{Binding Name}"/>
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

    </Grid>
</Window>