<Window
    x:Class="BasicIconProviderSample.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="BasicIconProvider Sample"
    Width="600"
    Height="450">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!--  パス入力  -->
        <TextBox
            x:Name="PathBox"
            Width="400"
            Height="28"
            Margin="0,0,0,10"
            VerticalAlignment="Center"
            Text="C:\Windows\explorer.exe" />

        <!--  アイコン取得ボタン  -->
        <Button
            Grid.Row="1"
            Width="120"
            Height="30"
            Margin="0,0,0,10"
            Click="OnGetIcon"
            Content="Get Icon" />

        <!--  取得したアイコン表示  -->
        <Image
            x:Name="IconImage"
            Grid.Row="2"
            Width="64"
            Height="64"
            Margin="0,0,0,20" />

        <!--  複数ファイルのアイコン一覧  -->
        <ListBox x:Name="FileList" Grid.Row="3">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Margin="0,4" Orientation="Horizontal">
                        <Image
                            Width="24"
                            Height="24"
                            Margin="0,0,10,0"
                            Source="{Binding Icon}" />
                        <TextBlock Text="{Binding Name}" />
                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>

    </Grid>
</Window>